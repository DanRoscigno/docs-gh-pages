<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-en/guides/ingest/tab_separated_values">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KF1LLRTQ5Q"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-KF1LLRTQ5Q",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="ClickHouse Docs" href="/docs-gh-pages/update-quick-start/opensearch.xml">



<script src="https://docs-content.clickhouse.tech/docs/js/analytics.js"></script><title data-rh="true">Ingest and query Tab Separated Value data in 5 steps | ClickHouse Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://path.to.prod.url/docs-gh-pages/update-quick-start/en/guides/ingest/tab_separated_values"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Ingest and query Tab Separated Value data in 5 steps | ClickHouse Docs"><meta data-rh="true" name="description" content="Tab separated value, or TSV, files are common and may include field headings as the first line of the file. ClickHouse can ingest TSVs, and also can query TSVs without ingesting the files.  This guide covers both of these cases. If you need to query or ingest CSV files, the same techniques work, simply substitute TSV with CSV in your format arguments."><meta data-rh="true" property="og:description" content="Tab separated value, or TSV, files are common and may include field headings as the first line of the file. ClickHouse can ingest TSVs, and also can query TSVs without ingesting the files.  This guide covers both of these cases. If you need to query or ingest CSV files, the same techniques work, simply substitute TSV with CSV in your format arguments."><link data-rh="true" rel="icon" href="/docs-gh-pages/update-quick-start/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://path.to.prod.url/docs-gh-pages/update-quick-start/en/guides/ingest/tab_separated_values"><link data-rh="true" rel="alternate" href="https://path.to.prod.url/docs-gh-pages/update-quick-start/en/guides/ingest/tab_separated_values" hreflang="en"><link data-rh="true" rel="alternate" href="https://path.to.prod.url/docs-gh-pages/update-quick-start/en/guides/ingest/tab_separated_values" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://62VCH2MD74-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/docs-gh-pages/update-quick-start/assets/css/styles.e7958b84.css">
<link rel="preload" href="/docs-gh-pages/update-quick-start/assets/js/runtime~main.94cde062.js" as="script">
<link rel="preload" href="/docs-gh-pages/update-quick-start/assets/js/main.e5f51d60.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs-gh-pages/update-quick-start/img/logo_without_text.svg" alt="ClickHouse" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs-gh-pages/update-quick-start/img/logo_without_text.svg" alt="ClickHouse" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">ClickHouse</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Product</a><ul class="dropdown__menu"><li><a href="https://clickhouse.com/cloud" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse Cloud</a></li><li><a href="https://clickhouse.com/clickhouse" target="_blank" rel="noopener noreferrer" class="dropdown__link">ClickHouse Open Source</a></li></ul></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-gh-pages/update-quick-start/en/intro">Docs</a><a href="https://clickhouse.com/customer-stories" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Use Cases</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Company</a><ul class="dropdown__menu"><li><a href="https://clickhouse.com/blog" target="_blank" rel="noopener noreferrer" class="dropdown__link">Blog</a></li><li><a href="https://clickhouse.com/company/our-story" target="_blank" rel="noopener noreferrer" class="dropdown__link">Our story</a></li><li><a href="https://clickhouse.com/company/careers" target="_blank" rel="noopener noreferrer" class="dropdown__link">Careers</a></li><li><a href="https://clickhouse.com/company/contact" target="_blank" rel="noopener noreferrer" class="dropdown__link">Contact us</a></li><li><a href="https://clickhouse.com/company/news-events" target="_blank" rel="noopener noreferrer" class="dropdown__link">News and events</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Language</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs-gh-pages/update-quick-start/en/intro">English</a></li><li><a class="dropdown__link" href="/docs-gh-pages/update-quick-start/ru">Russian</a></li><li><a class="dropdown__link" href="/docs-gh-pages/update-quick-start/zh">Chinese</a></li></ul></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-gh-pages/update-quick-start/en/intro">What is ClickHouse?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-gh-pages/update-quick-start/en/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs-gh-pages/update-quick-start/en/tutorial">Tutorial</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/en/getting-started/example-datasets">Example Datasets</a><button aria-label="Toggle the collapsible sidebar category &#x27;Example Datasets&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/en/integrations">Integrations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Integrations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/en/connect-a-ui">Connect a UI</a><button aria-label="Toggle the collapsible sidebar category &#x27;Connect a UI&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs-gh-pages/update-quick-start/en/guides">User Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;User Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs-gh-pages/update-quick-start/en/guides/developer">Developer Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs-gh-pages/update-quick-start/en/guides/sre">SRE Guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;SRE Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs-gh-pages/update-quick-start/en/guides/improving-query-performance">Improving Query Performance</a><button aria-label="Toggle the collapsible sidebar category &#x27;Improving Query Performance&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs-gh-pages/update-quick-start/en/guides/ingest">Ingest</a><button aria-label="Toggle the collapsible sidebar category &#x27;Ingest&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs-gh-pages/update-quick-start/en/guides/ingest/tab_separated_values">Tab Separated Value (TSV)</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/category/reference">Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/en/native-protocol">Native protocol</a><button aria-label="Toggle the collapsible sidebar category &#x27;Native protocol&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/en/faq">FAQ</a><button aria-label="Toggle the collapsible sidebar category &#x27;FAQ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/en/whats-new">What&#x27;s New</a><button aria-label="Toggle the collapsible sidebar category &#x27;What&#x27;s New&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs-gh-pages/update-quick-start/en/about-us">About Us</a><button aria-label="Toggle the collapsible sidebar category &#x27;About Us&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs-gh-pages/update-quick-start/en/guides"><span itemprop="name">User Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs-gh-pages/update-quick-start/en/guides/ingest"><span itemprop="name">Ingest</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Tab Separated Value (TSV)</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Ingest and query Tab Separated Value data in 5 steps</h1><p>Tab separated value, or TSV, files are common and may include field headings as the first line of the file. ClickHouse can ingest TSVs, and also can query TSVs without ingesting the files.  This guide covers both of these cases. If you need to query or ingest CSV files, the same techniques work, simply substitute <code>TSV</code> with <code>CSV</code> in your format arguments.</p><p>While working through this guide you will:</p><ul><li><strong>Investigate</strong>: Query the structure and content of the TSV file.</li><li><strong>Determine the target ClickHouse schema</strong>: Choose proper data types and map the existing data to those types.</li><li><strong>Create a ClickHouse table</strong>.</li><li><strong>Preprocess and stream</strong> the data to ClickHouse.</li><li><strong>Run some queries</strong> against ClickHouse.</li></ul><p>The dataset used in this guide comes from the NYC Open Data team, and contains data about &quot;all valid felony, misdemeanor, and violation crimes reported to the New York City Police Department (NYPD)&quot;. At the time of writing, the data file is 166MB, but it is updated regularly.</p><p><strong>Source</strong>: <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Current-Year-To-Date-/5uac-w243" target="_blank" rel="noopener noreferrer">data.cityofnewyork.us</a><br>
<strong>Terms of use</strong>: <a href="https://www1.nyc.gov/home/terms-of-use.page" target="_blank" rel="noopener noreferrer">https://www1.nyc.gov/home/terms-of-use.page</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><ul><li>Download the dataset by visiting the <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Current-Year-To-Date-/5uac-w243" target="_blank" rel="noopener noreferrer">NYPD Complaint Data Current (Year To Date)</a> page, clicking the Export button, and choosing <strong>TSV for Excel</strong>.</li><li>Install <a href="/docs-gh-pages/update-quick-start/en/getting-started/install">ClickHouse server and client</a>.</li><li><a href="/docs-gh-pages/update-quick-start/en/getting-started/install#launch">Launch</a> ClickHouse server, and connect with <code>clickhouse-client</code></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-note-about-the-commands-described-in-this-guide">A note about the commands described in this guide<a class="hash-link" href="#a-note-about-the-commands-described-in-this-guide" title="Direct link to heading">​</a></h3><p>There are two types of commands in this guide:</p><ul><li>Some of the commands are querying the TSV files, these are run at the command prompt.</li><li>The rest of the commands are querying ClickHouse, and these are run in the <code>clickhouse-client</code> or Play UI.</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The examples in this guide assume that you have saved the TSV file to <code>${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv</code>, please adjust the commands if needed.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="familiarize-yourself-with-the-tsv-file">Familiarize yourself with the TSV file<a class="hash-link" href="#familiarize-yourself-with-the-tsv-file" title="Direct link to heading">​</a></h2><p>Before starting to work with the ClickHouse database familiarize yourself with the data. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="look-at-the-fields-in-the-source-tsv-file">Look at the fields in the source TSV file<a class="hash-link" href="#look-at-the-fields-in-the-source-tsv-file" title="Direct link to heading">​</a></h3><p>This is an example of a command to query a TSV file, but don&#x27;t run it yet.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;describe file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Sample response</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_NUM                  Nullable(Float64)                   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ADDR_PCT_CD                 Nullable(Float64)                   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">BORO_NM                     Nullable(String)                    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_FR_DT                Nullable(String)                    </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_FR_TM                Nullable(String)                    </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Most of the time the above command will let you know which fields in the input data are numeric, and which are strings, and which are tuples.  This is not always the case.  Because ClickHouse is routineley used with datasets containing billions of records there is a default number (100) of rows examined to <a href="/docs-gh-pages/update-quick-start/en/guides/developer/working-with-json/json-semi-structured/#relying-on-schema-inference">infer the schema</a> in order to avoid parsing billions of rows to infer the schema. The response below may not match what you see, as the dataset is updated several times each year. Looking at the Data Dictionary you can see that CMPLNT_NUM is specified as text, and not numeric.  By overriding the default of 100 rows for inference with the setting <code>SETTINGS input_format_max_rows_to_read_for_schema_inference=2000</code>
you can get a better idea of the content.</p><p>Note: as of version 22.5 the default is now 25,000 rows for inferring the schema, so only change the setting if you are on an older version or if you need more than 25,000 rows to be sampled.</p></div></div><p>Run this command at your command prompt.  You will be using <code>clickhouse-local</code> to query the data in the TSV file you downloaded.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;describe file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)&quot; </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_NUM        Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ADDR_PCT_CD       Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">BORO_NM           Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_FR_DT      Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_FR_TM      Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_TO_DT      Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CMPLNT_TO_TM      Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">CRM_ATPT_CPTD_CD  Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">HADEVELOPT        Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">HOUSING_PSA       Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">JURISDICTION_CODE Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">JURIS_DESC        Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">KY_CD             Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LAW_CAT_CD        Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LOC_OF_OCCUR_DESC Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">OFNS_DESC         Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PARKS_NM          Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PATROL_BORO       Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PD_CD             Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PD_DESC           Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">PREM_TYP_DESC     Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">RPT_DT            Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">STATION_NAME      Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">SUSP_AGE_GROUP    Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">SUSP_RACE         Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">SUSP_SEX          Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">TRANSIT_DISTRICT  Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">VIC_AGE_GROUP     Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">VIC_RACE          Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">VIC_SEX           Nullable(String)                  </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">X_COORD_CD        Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Y_COORD_CD        Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Latitude          Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Longitude         Nullable(Float64)                 </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Lat_Lon           Tuple(Nullable(Float64), Nullable(Float64))                   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">New Georeferenced Column Nullable(String)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At this point you should check that the columns in the TSV file match the names and types specified in the <strong>Columns in this Dataset</strong> section of the <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Current-Year-To-Date-/5uac-w243" target="_blank" rel="noopener noreferrer">dataset web page</a>.  The data types are not very specific, all numeric fields are set to <code>Nullable(Float64)</code>, and all other fields are <code>Nullable(String)</code>.  When you create a ClickHouse table to store the data you can specify more appropriate and performant types.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="determine-the-proper-schema">Determine the proper schema<a class="hash-link" href="#determine-the-proper-schema" title="Direct link to heading">​</a></h3><p>In order to figure out what types should be used for the fields it is necessary to know what the data looks like. For example, the field <code>JURISDICTION_CODE</code> is a numeric: should it be a <code>UInt8</code>, or an <code>Enum</code>, or is <code>Float64</code> appropriate?</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">local</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">--input_format_max_rows_to_read_for_schema_inference=2000 \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">--query \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token string" style="color:rgb(163, 21, 21)">&quot;select JURISDICTION_CODE, count() FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)"> file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)"> GROUP BY JURISDICTION_CODE</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)"> ORDER BY JURISDICTION_CODE</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)"> FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─JURISDICTION_CODE─┬─count()─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 0 │  188875 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 1 │    4799 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 2 │   13833 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 3 │     656 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 4 │      51 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 6 │       5 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 7 │       2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 9 │      13 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                11 │      14 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                12 │       5 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                13 │       2 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                14 │      70 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                15 │      20 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                72 │     159 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                87 │       9 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                88 │      75 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                97 │     405 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────┴─────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The query response shows that the <code>JURISDICTION_CODE</code> fits well in a <code>UInt8</code>.</p><p>Similarly, look at some of the <code>String</code> fields and see if they are well suited to being <code>DateTime</code> or <a href="/docs-gh-pages/update-quick-start/en/sql-reference/data-types/lowcardinality"><code>LowCardinality(String)</code></a> fields.</p><p>For example, the field <code>PARKS_NM</code> is described as &quot;Name of NYC park, playground or greenspace of occurrence, if applicable (state parks are not included)&quot;.  The names of parks in New York City may be a good candidate for a <code>LowCardinality(String)</code>:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;select count(distinct PARKS_NM) FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"> FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─uniqExact(PARKS_NM)─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                 319 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Have a look at some of the park names:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">local</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">--input_format_max_rows_to_read_for_schema_inference=2000 \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">--query \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token string" style="color:rgb(163, 21, 21)">&quot;select distinct PARKS_NM FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)"> file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)"> LIMIT 10</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)"> FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─PARKS_NM───────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ (null)                     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ ASSER LEVY PARK            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ JAMES J WALKER PARK        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ BELT PARKWAY/SHORE PARKWAY │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ PROSPECT PARK              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ MONTEFIORE SQUARE          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ SUTTON PLACE PARK          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ JOYCE KILMER PARK          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ ALLEY ATHLETIC PLAYGROUND  │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ ASTORIA PARK               │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The dataset in use at the time of writing has only a few hundred distinct parks and playgrounds in the <code>PARK_NM</code> column.  This is a small number based on the <a href="/docs-gh-pages/update-quick-start/en/sql-reference/data-types/lowcardinality#lowcardinality-dscr">LowCardinality</a> recommendation to stay below 10,000 distinct strings in a <code>LowCardinality(String)</code> field.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="datetime-fields">DateTime fields<a class="hash-link" href="#datetime-fields" title="Direct link to heading">​</a></h3><p>Based on the <strong>Columns in this Dataset</strong> section of the <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Current-Year-To-Date-/5uac-w243" target="_blank" rel="noopener noreferrer">dataset web page</a> there are date and time fields for the start and end of the reported event.  Looking at the min and max of the <code>CMPLNT_FR_DT</code> and <code>CMPLT_TO_DT</code> gives an idea of whether or not the fields are always populated:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockTitle_Ktv7">CMPLNT_FR_DT</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;select min(CMPLNT_FR_DT), max(CMPLNT_FR_DT) FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─min(CMPLNT_FR_DT)─┬─max(CMPLNT_FR_DT)─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 01/01/1973        │ 12/31/2021        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────┴───────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockTitle_Ktv7">CMPLNT_TO_DT</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;select min(CMPLNT_TO_DT), max(CMPLNT_TO_DT) FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─min(CMPLNT_TO_DT)─┬─max(CMPLNT_TO_DT)─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│                   │ 12/31/2021        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────┴───────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockTitle_Ktv7">CMPLNT_FR_TM</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;select min(CMPLNT_FR_TM), max(CMPLNT_FR_TM) FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─min(CMPLNT_FR_TM)─┬─max(CMPLNT_FR_TM)─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 00:00:00          │ 23:59:00          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────┴───────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockTitle_Ktv7">CMPLNT_TO_TM</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;select min(CMPLNT_TO_TM), max(CMPLNT_TO_TM) FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─min(CMPLNT_TO_TM)─┬─max(CMPLNT_TO_TM)─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ (null)            │ 23:59:00          │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────┴───────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="make-a-plan">Make a plan<a class="hash-link" href="#make-a-plan" title="Direct link to heading">​</a></h2><p>Based on the above investigation:</p><ul><li><code>JURISDICTION_CODE</code> should be cast as <code>UInt8</code>.</li><li><code>PARKS_NM</code> should be cast to <code>LowCardinality(String)</code></li><li><code>CMPLNT_FR_DT</code> and <code>CMPLNT_FR_TM</code> are always populated (possibly with a default time of <code>00:00:00</code>)</li><li><code>CMPLNT_TO_DT</code> and <code>CMPLNT_TO_TM</code> may be empty</li><li>Dates and times are stored in separate fields in the source</li><li>Dates are <code>mm/dd/yyyy</code> format</li><li>Times are <code>hh:mm:ss</code> format</li><li>Dates and times can be concatenated into DateTime types</li><li>There are some dates before January 1st 1970, which means we need a 64 bit DateTime</li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>There are many more changes to be made to the types, they all can be determined by following the same investigation steps.  Look at the number of distinct strings in a field, the min and max of the numerics, and make your decisions.  The table schema that is given later in the guide has many low cardinality strings and unsigned integer fields and very few floating point numerics.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="concatenate-the-date-and-time-fields">Concatenate the date and time fields<a class="hash-link" href="#concatenate-the-date-and-time-fields" title="Direct link to heading">​</a></h2><p>To concatenate the date and time fields <code>CMPLNT_FR_DT</code> and <code>CMPLNT_FR_TM</code> into a single <code>String</code> that can be cast to a <code>DateTime</code>, select the two fields joined by the concatenation operator: <code>CMPLNT_FR_DT || &#x27; &#x27; || CMPLNT_FR_TM</code>.  The <code>CMPLNT_TO_DT</code> and <code>CMPLNT_TO_TM</code> fields are handled similarly.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;select CMPLNT_FR_DT || &#x27; &#x27; || CMPLNT_FR_TM AS complaint_begin FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LIMIT 10</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─complaint_begin─────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 07/29/2010 00:01:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 12/01/2011 12:00:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 04/01/2017 15:00:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 03/26/2018 17:20:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 01/01/2019 00:00:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 06/14/2019 00:00:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 11/29/2021 20:00:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 12/04/2021 00:35:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 12/05/2021 12:50:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 12/07/2021 20:30:00 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="convert-the-date-and-time-string-to-a-datetime64-type">Convert the date and time String to a DateTime64 type<a class="hash-link" href="#convert-the-date-and-time-string-to-a-datetime64-type" title="Direct link to heading">​</a></h2><p>Earlier in the guide we discovered that there are dates in the TSV file before January 1st 1970, which means that we need a 64 bit DateTime type for the dates.  The dates also need to be converted from <code>MM/DD/YYYY</code> to <code>YYYY/MM/DD</code> format.  Both of these can be done with <a href="/docs-gh-pages/update-quick-start/en/sql-reference/functions/type-conversion-functions#parsedatetime64besteffort"><code>parseDateTime64BestEffort()</code></a>.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference=2000 \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">&quot;WITH (CMPLNT_FR_DT || &#x27; &#x27; || CMPLNT_FR_TM) AS CMPLNT_START,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      (CMPLNT_TO_DT || &#x27; &#x27; || CMPLNT_TO_TM) AS CMPLNT_END</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">select parseDateTime64BestEffort(CMPLNT_START) AS complaint_begin,</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">       parseDateTime64BestEffortOrNull(CMPLNT_END) AS complaint_end</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FROM file(&#x27;${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">ORDER BY complaint_begin ASC</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">LIMIT 25</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lines 2 and 3 above contain the concatenation from the previous step, and lines 4 and 5 above parse the strings into <code>DateTime64</code>.  As the complaint end time is not guaranteed to exist <code>parseDateTime64BestEffortOrNull</code> is used.</p><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─────────complaint_begin─┬───────────complaint_end─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1925-01-01 10:00:00.000 │ 2021-02-12 09:30:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1925-01-01 11:37:00.000 │ 2022-01-16 11:49:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1925-01-01 15:00:00.000 │ 2021-12-31 00:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1925-01-01 15:00:00.000 │ 2022-02-02 22:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1925-01-01 19:00:00.000 │ 2022-04-14 05:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1955-09-01 19:55:00.000 │ 2022-08-01 00:45:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1972-03-17 11:40:00.000 │ 2022-03-17 11:43:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1972-05-23 22:00:00.000 │ 2022-05-24 09:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1972-05-30 23:37:00.000 │ 2022-05-30 23:50:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1972-07-04 02:17:00.000 │                    ᴺᵁᴸᴸ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1973-01-01 00:00:00.000 │                    ᴺᵁᴸᴸ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1975-01-01 00:00:00.000 │                    ᴺᵁᴸᴸ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1976-11-05 00:01:00.000 │ 1988-10-05 23:59:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1977-01-01 00:00:00.000 │ 1977-01-01 23:59:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1977-12-20 00:01:00.000 │                    ᴺᵁᴸᴸ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1981-01-01 00:01:00.000 │                    ᴺᵁᴸᴸ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1981-08-14 00:00:00.000 │ 1987-08-13 23:59:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1983-01-07 00:00:00.000 │ 1990-01-06 00:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1984-01-01 00:01:00.000 │ 1984-12-31 23:59:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1985-01-01 12:00:00.000 │ 1987-12-31 15:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1985-01-11 09:00:00.000 │ 1985-12-31 12:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1986-03-16 00:05:00.000 │ 2022-03-16 00:45:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1987-01-07 00:00:00.000 │ 1987-01-09 00:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1988-04-03 18:30:00.000 │ 2022-08-03 09:45:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 1988-07-29 12:00:00.000 │ 1990-07-27 22:00:00.000 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────┴─────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The dates shown as <code>1925</code> above are from errors in the data.  There are several records in the original data with dates in the years <code>1019</code> - <code>1022</code> that should be <code>2019</code> - <code>2022</code>.  They are being stored as Jan 1st 1925 as that is the earliest date with a 64 bit DateTime.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-table">Create a table<a class="hash-link" href="#create-a-table" title="Direct link to heading">​</a></h2><p>The decisions made above on the data types used for the columns are reflected in the table schema
below. We also need to decide on the <code>ORDER BY</code> and <code>PRIMARY KEY</code> used for the table.  At least one
of <code>ORDER BY</code> or <code>PRIMARY KEY</code> must be specified.  Here are some guidelines on deciding on the
columns to includes in <code>ORDER BY</code>, and more information is in the <em>Next Steps</em> section at the end
of this document.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="order-by-and-primary-key-clauses">Order By and Primary Key clauses<a class="hash-link" href="#order-by-and-primary-key-clauses" title="Direct link to heading">​</a></h3><ul><li>The <code>ORDER BY</code> tuple should include fields that are used in query filters</li><li>To maximize compression on disk the <code>ORDER BY</code> tuple should be ordered by ascending cardinality</li><li>If it exists, the <code>PRIMARY KEY</code> tuple must be a subset of the <code>ORDER BY</code> tuple</li><li>If only <code>ORDER BY</code> is specified, then the same tuple will be used as <code>PRIMARY KEY</code></li><li>The primary key index is created using the <code>PRIMARY KEY</code> tuple if specified, otherwise the <code>ORDER BY</code> tuple</li><li>The <code>PRIMARY KEY</code> index is kept in main memory</li></ul><p>Looking at the dataset and the questions that might be answered by querying it we might
decide that we would look at the types of crimes reported over time in the five boroughs of
New York City.  These fields might be then included in the <code>ORDER BY</code>:</p><table><thead><tr><th>Column</th><th>Description (from the data dictionary)</th></tr></thead><tbody><tr><td>OFNS_DESC</td><td>Description of offense corresponding with key code</td></tr><tr><td>RPT_DT</td><td>Date event was reported to police</td></tr><tr><td>BORO_NM</td><td>The name of the borough in which the incident occurred</td></tr></tbody></table><p>Querying the TSV file for the cardinality of the three candidate columns:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">clickhouse-local --input_format_max_rows_to_read_for_schema_inference</span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token number" style="color:rgb(9, 134, 88)">2000</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">--query </span><span class="token punctuation" style="color:rgb(4, 81, 165)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token string" style="color:rgb(163, 21, 21)">&quot;select formatReadableQuantity(uniq(OFNS_DESC)) as cardinality_OFNS_DESC,</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">        formatReadableQuantity(uniq(RPT_DT)) as cardinality_RPT_DT,</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">        formatReadableQuantity(uniq(BORO_NM)) as cardinality_BORO_NM</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">  FROM</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">  file(&#x27;</span><span class="token string variable" style="color:rgb(9, 134, 88)">${</span><span class="token string variable environment constant" style="color:rgb(129, 31, 63)">HOME</span><span class="token string variable" style="color:rgb(9, 134, 88)">}</span><span class="token string" style="color:rgb(163, 21, 21)">/NYPD_Complaint_Data_Current__Year_To_Date_.tsv&#x27;, &#x27;TSVWithNames&#x27;)</span><br></span><span class="token-line" style="color:#000000"><span class="token string" style="color:rgb(163, 21, 21)">  FORMAT PrettyCompact&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─cardinality_OFNS_DESC─┬─cardinality_RPT_DT─┬─cardinality_BORO_NM─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 60.00                 │ 306.00             │ 6.00                │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────────────┴────────────────────┴─────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Ordering by cardinality, the <code>ORDER BY</code> becomes:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ORDER BY ( BORO_NM, OFNS_DESC, RPT_DT )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The table below will use more easily read column names, the above names will be mapped to</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">ORDER BY ( borough, offense_description, date_reported )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><p>Putting together the changes to data types and the <code>ORDER BY</code> tuple gives this table structure:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">TABLE</span><span class="token plain"> NYPD_Complaint </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    complaint_number     String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    precinct             UInt8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    borough              LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    complaint_begin      DateTime64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;America/New_York&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    complaint_end        DateTime64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;America/New_York&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    was_crime_completed  String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    housing_authority    String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    housing_level_code   UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    jurisdiction_code    UInt8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    jurisdiction         LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    offense_code         UInt8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    offense_level        LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location_descriptor  LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    offense_description  LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    park_name            LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    patrol_borough       LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PD_CD                UInt16</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    PD_DESC              String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    location_type        LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    date_reported        </span><span class="token keyword" style="color:rgb(0, 0, 255)">Date</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    transit_station      LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    suspect_age_group    LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    suspect_race         LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    suspect_sex          LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    transit_district     UInt8</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    victim_age_group     LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    victim_race          LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    victim_sex           LowCardinality</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">String</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    NY_x_coordinate      UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    NY_y_coordinate      UInt32</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Latitude             Float64</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    Longitude            Float64</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> MergeTree</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"> borough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> offense_description</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> date_reported </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="finding-the-primary-key-of-a-table">Finding the primary key of a table<a class="hash-link" href="#finding-the-primary-key-of-a-table" title="Direct link to heading">​</a></h3><p>The ClickHouse <code>system</code> database, specifically <code>system.table</code> has all of the information about the table you
just created.  This query shows the <code>ORDER BY</code> (sorting key), and the <code>PRIMARY KEY</code>:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    partition_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    sorting_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    primary_key</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">table</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;NYPD_Complaint&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">FORMAT Vertical</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Response</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Query id: 6a5b10bf-9333-4090-b36e-c7f08b1d9e01</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">Row 1:</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">──────</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">partition_key: </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">sorting_key:   borough, offense_description, date_reported</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">primary_key:   borough, offense_description, date_reported</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">table:         NYPD_Complaint</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1 row in set. Elapsed: 0.001 sec.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="preprocess-import-data">Preprocess and Import Data<a class="hash-link" href="#preprocess-import-data" title="Direct link to heading">​</a></h2><p>We will use <code>clickhouse-local</code> tool for data preprocessing and <code>clickhouse-client</code> to upload it.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="clickhouse-local-arguments-used"><code>clickhouse-local</code> arguments used<a class="hash-link" href="#clickhouse-local-arguments-used" title="Direct link to heading">​</a></h3><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p><code>table=&#x27;input&#x27;</code> appears in the arguments to clickhouse-local below.  clickhouse-local takes the provided input (<code>cat ${HOME}/NYPD_Complaint_Data_Current__Year_To_Date_.tsv</code>) and inserts the input into a table.  By default the table is named <code>table</code>.  In this guide the name of the table is set to <code>input</code> to make the data flow clearer. The final argument to clickhouse-local is a query that selects from the table (<code>FROM input</code>) which is then piped to <code>clickhouse-client</code> to populate the table <code>NYPD_Complaint</code>.</p></div></div><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">cat ${HOME}</span><span class="token operator" style="color:rgb(0, 0, 0)">/</span><span class="token plain">NYPD_Complaint_Data_Current__Year_To_Date_</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">tsv \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> clickhouse</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token keyword" style="color:rgb(0, 0, 255)">local</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">--table=&#x27;input&#x27; --input-format=&#x27;TSVWithNames&#x27; \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">--input_format_max_rows_to_read_for_schema_inference=2000 \</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token comment" style="color:rgb(0, 128, 0)">--query &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">WITH</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">CMPLNT_FR_DT </span><span class="token operator" style="color:rgb(0, 0, 0)">||</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">||</span><span class="token plain"> CMPLNT_FR_TM</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> CMPLNT_START</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">     </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">CMPLNT_TO_DT </span><span class="token operator" style="color:rgb(0, 0, 0)">||</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27; &#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">||</span><span class="token plain"> CMPLNT_TO_TM</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> CMPLNT_END</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      CMPLNT_NUM                                  </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> complaint_number</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      ADDR_PCT_CD                                 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> precinct</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      BORO_NM                                     </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> borough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      parseDateTime64BestEffort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">CMPLNT_START</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">     </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> complaint_begin</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      parseDateTime64BestEffortOrNull</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">CMPLNT_END</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> complaint_end</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      CRM_ATPT_CPTD_CD                            </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> was_crime_completed</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      HADEVELOPT                                  </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> housing_authority_development</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      HOUSING_PSA                                 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> housing_level_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      JURISDICTION_CODE                           </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> jurisdiction_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      JURIS_DESC                                  </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> jurisdiction</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      KY_CD                                       </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> offense_code</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      LAW_CAT_CD                                  </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> offense_level</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      LOC_OF_OCCUR_DESC                           </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> location_descriptor</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      OFNS_DESC                                   </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> offense_description</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      PARKS_NM                                    </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> park_name</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      PATROL_BORO                                 </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> patrol_borough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      PD_CD</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      PD_DESC</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      PREM_TYP_DESC                               </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> location_type</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      toDate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">parseDateTimeBestEffort</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">RPT_DT</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain">     </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> date_reported</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      STATION_NAME                                </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> transit_station</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      SUSP_AGE_GROUP                              </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> suspect_age_group</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      SUSP_RACE                                   </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> suspect_race</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      SUSP_SEX                                    </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> suspect_sex</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      TRANSIT_DISTRICT                            </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> transit_district</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      VIC_AGE_GROUP                               </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> victim_age_group</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      VIC_RACE                                    </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> victim_race</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      VIC_SEX                                     </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> victim_sex</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      X_COORD_CD                                  </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> NY_x_coordinate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      Y_COORD_CD                                  </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> NY_y_coordinate</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      Latitude</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">      Longitude</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> input&quot; \</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">  </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> clickhouse</span><span class="token operator" style="color:rgb(0, 0, 0)">-</span><span class="token plain">client </span><span class="token comment" style="color:rgb(0, 128, 0)">--query=&#x27;INSERT INTO NYPD_Complaint FORMAT TSV&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="validate-data">Validate the Data<a class="hash-link" href="#validate-data" title="Direct link to heading">​</a></h2><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The dataset changes once or more per year, your counts may not match what is in this document.</p></div></div><p>Query:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> NYPD_Complaint</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─count()─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│  208993 │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">1 row in set. Elapsed: 0.001 sec. </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The size of the dataset in ClickHouse is just 12% of the original TSV file, compare the size of the original TSV file with the size of the table:</p><p>Query:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"> formatReadableSize</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">total_bytes</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> system</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token keyword" style="color:rgb(0, 0, 255)">tables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">WHERE</span><span class="token plain"> name </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;NYPD_Complaint&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">┌─formatReadableSize(total_bytes)─┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ 8.63 MiB                        │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└─────────────────────────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="run-queries">Run Some Queries<a class="hash-link" href="#run-queries" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-1-compare-the-number-of-complaints-by-month">Query 1. Compare the number of complaints by month<a class="hash-link" href="#query-1-compare-the-number-of-complaints-by-month" title="Direct link to heading">​</a></h3><p>Query:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    dateName</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;month&#x27;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> date_reported</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">month</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> complaints</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">complaints</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">50000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">80</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> NYPD_Complaint</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">month</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> complaints </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Query id: 7fbd4244-b32a-4acf-b1f3-c3aa198e74d9</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─month─────┬─complaints─┬─bar(count(), 0, 50000, 80)───────────────────────────────┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ March     │      34536 │ ███████████████████████████████████████████████████████▎ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ May       │      34250 │ ██████████████████████████████████████████████████████▋  │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ April     │      32541 │ ████████████████████████████████████████████████████     │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ January   │      30806 │ █████████████████████████████████████████████████▎       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ February  │      28118 │ ████████████████████████████████████████████▊            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ November  │       7474 │ ███████████▊                                             │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ December  │       7223 │ ███████████▌                                             │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ October   │       7070 │ ███████████▎                                             │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ September │       6910 │ ███████████                                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ August    │       6801 │ ██████████▊                                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ June      │       6779 │ ██████████▋                                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ July      │       6485 │ ██████████▍                                              │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────┴────────────┴──────────────────────────────────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">12 rows in set. Elapsed: 0.006 sec. Processed 208.99 thousand rows, 417.99 KB (37.48 million rows/s., 74.96 MB/s.)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-2-compare-total-number-of-complaints-by-borough">Query 2. Compare total number of complaints by Borough<a class="hash-link" href="#query-2-compare-total-number-of-complaints-by-borough" title="Direct link to heading">​</a></h3><p>Query:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    borough</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function" style="color:rgb(0, 0, 255)">count</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">AS</span><span class="token plain"> complaints</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">    bar</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">complaints</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">0</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">125000</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(9, 134, 88)">60</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">FROM</span><span class="token plain"> NYPD_Complaint</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> borough</span><br></span><span class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">BY</span><span class="token plain"> complaints </span><span class="token keyword" style="color:rgb(0, 0, 255)">DESC</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Result:</p><div class="language-response codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#000000;--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-response codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#000000"><span class="token plain">Query id: 8cdcdfd4-908f-4be0-99e3-265722a2ab8d</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">┌─borough───────┬─complaints─┬─bar(count(), 0, 125000, 60)──┐</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ BROOKLYN      │      57947 │ ███████████████████████████▋ │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ MANHATTAN     │      53025 │ █████████████████████████▍   │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ QUEENS        │      44875 │ █████████████████████▌       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ BRONX         │      44260 │ █████████████████████▏       │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ STATEN ISLAND │       8503 │ ████                         │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">│ (null)        │        383 │ ▏                            │</span><br></span><span class="token-line" style="color:#000000"><span class="token plain">└───────────────┴────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#000000"><span class="token plain">6 rows in set. Elapsed: 0.008 sec. Processed 208.99 thousand rows, 209.43 KB (27.14 million rows/s., 27.20 MB/s.)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a class="hash-link" href="#next-steps" title="Direct link to heading">​</a></h2><p><a href="/docs-gh-pages/update-quick-start/en/guides/improving-query-performance/sparse-primary-indexes/sparse-primary-indexes-intro">A Practical Introduction to Sparse Primary Indexes in ClickHouse</a> discusses the differences in ClickHouse indexing compared to traditional relational databases, how ClickHouse builds and uses a sparse primary index, and indexing best practices.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ClickHouse/clickhouse-docs/blob/main/docs/en/guides/ingest/tab_separated_values.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs-gh-pages/update-quick-start/en/guides/ingest"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Ingest</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs-gh-pages/update-quick-start/category/reference"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Reference</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#a-note-about-the-commands-described-in-this-guide" class="table-of-contents__link toc-highlight">A note about the commands described in this guide</a></li></ul></li><li><a href="#familiarize-yourself-with-the-tsv-file" class="table-of-contents__link toc-highlight">Familiarize yourself with the TSV file</a><ul><li><a href="#look-at-the-fields-in-the-source-tsv-file" class="table-of-contents__link toc-highlight">Look at the fields in the source TSV file</a></li><li><a href="#determine-the-proper-schema" class="table-of-contents__link toc-highlight">Determine the proper schema</a></li><li><a href="#datetime-fields" class="table-of-contents__link toc-highlight">DateTime fields</a></li></ul></li><li><a href="#make-a-plan" class="table-of-contents__link toc-highlight">Make a plan</a></li><li><a href="#concatenate-the-date-and-time-fields" class="table-of-contents__link toc-highlight">Concatenate the date and time fields</a></li><li><a href="#convert-the-date-and-time-string-to-a-datetime64-type" class="table-of-contents__link toc-highlight">Convert the date and time String to a DateTime64 type</a></li><li><a href="#create-a-table" class="table-of-contents__link toc-highlight">Create a table</a><ul><li><a href="#order-by-and-primary-key-clauses" class="table-of-contents__link toc-highlight">Order By and Primary Key clauses</a></li><li><a href="#finding-the-primary-key-of-a-table" class="table-of-contents__link toc-highlight">Finding the primary key of a table</a></li></ul></li><li><a href="#preprocess-import-data" class="table-of-contents__link toc-highlight">Preprocess and Import Data</a><ul><li><a href="#clickhouse-local-arguments-used" class="table-of-contents__link toc-highlight"><code>clickhouse-local</code> arguments used</a></li></ul></li><li><a href="#validate-data" class="table-of-contents__link toc-highlight">Validate the Data</a></li><li><a href="#run-queries" class="table-of-contents__link toc-highlight">Run Some Queries</a><ul><li><a href="#query-1-compare-the-number-of-complaints-by-month" class="table-of-contents__link toc-highlight">Query 1. Compare the number of complaints by month</a></li><li><a href="#query-2-compare-total-number-of-complaints-by-borough" class="table-of-contents__link toc-highlight">Query 2. Compare total number of complaints by Borough</a></li></ul></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">ClickHouse</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://clickhouse.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Company</a></li><li class="footer__item"><a href="https://clickhouse.com/cloud/" target="_blank" rel="noopener noreferrer" class="footer__link-item">ClickHouse as a Service</a></li><li class="footer__item"><a href="https://clickhouse.com/careers/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Careers</a></li><li class="footer__item"><a href="https://clickhouse.com/learn/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Learn ClickHouse</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/ClickHouse/ClickHouse" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://clickhouse.com/blog/en/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.meetup.com/pro/clickhouse/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Meetup<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/ClickHouseDB" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/clickhousedb/shared_invite/zt-rxm3rdrk-lIUmhLC3V8WTaL0TGxsOmg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Policies</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://clickhouse.com/legal/trademark-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Trademark Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/privacy-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://clickhouse.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/docs-gh-pages/update-quick-start/img/logo_without_text.svg" alt="ClickHouse Documentation" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/docs-gh-pages/update-quick-start/img/logo_without_text.svg" alt="ClickHouse Documentation" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></div><div class="footer__copyright">Copyright &copy; 2016&ndash;2022 ClickHouse, Inc. ClickHouse Docs provided under the Creative Commons CC BY-NC-SA 4.0 license. ClickHouse&reg; is a registered trademark of ClickHouse, Inc.</div></div></div></footer></div>
<script src="/docs-gh-pages/update-quick-start/assets/js/runtime~main.94cde062.js"></script>
<script src="/docs-gh-pages/update-quick-start/assets/js/main.e5f51d60.js"></script>
</body>
</html>